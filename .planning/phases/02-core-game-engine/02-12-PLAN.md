---
phase: 02-core-game-engine
plan: 12
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/game/GameBoard.tsx
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "Chat drawer is visible at bottom of game screen (collapsed by default)"
    - "Players can click to expand chat and see message history"
    - "Players can type and send messages while in game"
    - "Spectators see amber banner at top indicating spectator status"
    - "Spectators can dismiss the banner"
  artifacts:
    - path: "src/components/game/GameBoard.tsx"
      provides: "Integration of GameChat and SpectatorBanner components"
      min_lines: 310
  key_links:
    - from: "src/components/game/GameBoard.tsx"
      to: "src/components/game/GameChat.tsx"
      via: "import and render with roomId, socket, currentUserId props"
      pattern: "import.*GameChat.*from.*GameChat"
    - from: "src/components/game/GameBoard.tsx"
      to: "src/components/game/SpectatorBanner.tsx"
      via: "import and render with isSpectator prop"
      pattern: "import.*SpectatorBanner.*from.*SpectatorBanner"
---

<objective>
Integrate the fully-built GameChat and SpectatorBanner components into GameBoard.tsx to enable in-game messaging and spectator notifications.

Purpose: Close UAT gap #9 - chat area was built in plan 02-08 but never wired into the game UI. This is a simple integration task to connect existing, working components.

Output: GameBoard.tsx renders chat drawer and spectator banner with proper props
</objective>

<execution_context>
@C:\Users\maxi\.claude\get-shit-done\workflows\execute-plan.md
@C:\Users\maxi\.claude\get-shit-done\templates\summary.md
</execution_context>

<context>
@C:\Users\maxi\Documents\Coding\game-site\.planning\PROJECT.md
@C:\Users\maxi\Documents\Coding\game-site\.planning\ROADMAP.md
@C:\Users\maxi\Documents\Coding\game-site\.planning\STATE.md
@C:\Users\maxi\Documents\Coding\game-site\src\components\game\GameBoard.tsx
@C:\Users\maxi\Documents\Coding\game-site\src\components\game\GameChat.tsx
@C:\Users\maxi\Documents\Coding\game-site\src\components\game\SpectatorBanner.tsx
@C:\Users\maxi\Documents\Coding\game-site\src\types\game.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Import and render GameChat and SpectatorBanner in GameBoard.tsx</name>
  <files>src/components/game/GameBoard.tsx</files>
  <action>
Add imports at the top of GameBoard.tsx (after existing imports, around line 12):
```typescript
import { GameChat } from './GameChat'
import { SpectatorBanner } from './SpectatorBanner'
```

Add spectator detection logic after line 33 (after `isHost` constant):
```typescript
const isSpectator = localGameState.spectators.includes(currentUserId)
```

Render SpectatorBanner at the very beginning of the return statement (before the existing top bar div at line 128), so it appears above all game content:
```typescript
<>
  <SpectatorBanner isSpectator={isSpectator} />
  <div className="flex min-h-screen flex-col bg-gradient-to-br from-gray-900 to-gray-800">
    {/* existing content */}
  </div>
  <GameChat
    roomId={roomId}
    socket={socket}
    currentUserId={currentUserId}
  />
</>
```

**Important:** Wrap the entire return in a React fragment (`<>...</>`) to allow multiple root elements. The SpectatorBanner renders above the game container, and GameChat renders as a fixed-position drawer at the bottom.

**Why this structure:**
- SpectatorBanner is fixed position (top) with z-50, appears above game UI
- GameChat is fixed position (bottom) with z-40, appears as drawer
- Both components already handle their own positioning - no layout adjustments needed in GameBoard
  </action>
  <verify>
Build succeeds: `npm run build`
No TypeScript errors: `npx tsc --noEmit`
Imports resolve correctly (GameChat and SpectatorBanner are adjacent to GameBoard in same folder)
  </verify>
  <done>
GameBoard.tsx imports GameChat and SpectatorBanner, calculates isSpectator from gameState.spectators, renders both components with correct props. Build completes without errors.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Integrated GameChat drawer and SpectatorBanner into the game UI. Chat appears as collapsible drawer at bottom, spectator banner appears at top for spectators.
  </what-built>
  <how-to-verify>
1. Start dev server: `npm run dev`
2. Navigate to an active game room or create a new one
3. As a player:
   - Look for chat icon/bar at bottom of screen (collapsed state)
   - Click to expand chat drawer
   - Type a test message and send (Enter or Send button)
   - Verify message appears in chat history
   - Collapse chat, verify unread badge appears on new messages
4. As a spectator (join a full room):
   - Verify amber banner appears at top saying "Du kannst in der n√§chsten Runde mitspielen"
   - Click X to dismiss banner
   - Verify banner disappears
   - Verify chat still works for spectators
5. Test responsiveness:
   - Chat drawer should be 40vh on mobile, 320px on desktop
   - Banner should adapt to mobile (stacked text) and desktop (inline)

Expected behavior:
- Chat drawer is visible and functional
- Messages send and receive in real-time via socket
- Spectator banner shows for spectators only
- Both components overlay game UI without breaking layout
  </how-to-verify>
  <resume-signal>Type "approved" to confirm chat and spectator banner work, or describe any issues</resume-signal>
</task>

</tasks>

<verification>
1. Build check: `npm run build` succeeds
2. Type check: `npx tsc --noEmit` shows no errors
3. Import resolution: GameChat and SpectatorBanner resolve from `./GameChat` and `./SpectatorBanner`
4. Props correctness:
   - GameChat receives roomId (string), socket (Socket), currentUserId (string)
   - SpectatorBanner receives isSpectator (boolean)
5. Runtime check: Chat drawer appears at bottom, spectator banner appears at top for spectators
</verification>

<success_criteria>
- GameBoard.tsx imports GameChat and SpectatorBanner
- isSpectator calculated as `localGameState.spectators.includes(currentUserId)`
- SpectatorBanner rendered with isSpectator prop
- GameChat rendered with roomId, socket, currentUserId props
- Chat drawer is visible and functional in game UI
- Spectator banner appears for spectators only
- No TypeScript or build errors
- User confirms chat and spectator features work as expected
</success_criteria>

<output>
After completion, create `.planning/phases/02-core-game-engine/02-12-SUMMARY.md`
</output>
